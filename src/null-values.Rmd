---
title: "Simple SQL examples within R: NULL values"
author: "Steve Simon"
date: "September 12, 2017"
output: powerpoint_presentation
---

### NULL values in SQL
+ NULL is a special value in SQL
  + Typically intended to represent unknown or missing values
  + Always ask "why?"
+ Database designer may forbid use of NULL

<div class="notes">



</div>

### Example of NULL values in a database

![List of selected rows of a database in SQLite Studio](../images/sql-missing.png)

<div class="notes">

Here's a peek at several rows of a database where there are some NULL values.

</div>

### SAS translation of NULL

![List of selected rows of a database after import into SAS](../images/sas-missing.png)

<div class="notes">

SQL uses the term NULL to refer to missing values. In R, these NULL values are converted to NA, the R code for missing values. In SAS, these are converted to ., the SAS code for missing values.

You can select records with missing values by specifying IS NULL in the WHERE statement.

</div>

```{r}
library(sqldf)
db <- dbConnect(SQLite(), dbname="../data/titanic.sqlite")

dbGetQuery(conn=db,
 "select PClass, Age
    FROM ti
    where name like 'Bar%'")
```

```{r is-null}
dbGetQuery(conn=db,
 "SELECT COUNT(Name) AS n_missing FROM ti
 WHERE Age IS NULL")
```

You can exclude missing values using IS NOT NULL.

```{r is-not-null}
dbGetQuery(conn=db,
 "SELECT COUNT(Name) AS n_valid FROM ti
 WHERE Age IS NOT NULL")
```

In SQL, statistical summary functions will remove missing values and calculate based only on the non-missing values. This is similar to the default options in SAS and SPSS, which also exclude missing values by default in most summary statistics. In R, however, the default option is to return a missing value for a summary statistic anytime that one or more values are missing.

```{r statistical-summary-of-nulls}
dbGetQuery(conn=db,
 "SELECT COUNT(Age) AS n_valid FROM ti")
dbGetQuery(conn=db,
 "SELECT AVG(Age) AS mean_age FROM ti")
```

```{r shut-down-gracefully}
dbDisconnect(conn=db)
```

```
